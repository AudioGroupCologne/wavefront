use std::f32::consts::PI;
use std::fmt;

use bevy::prelude::*;
use egui::epaint::{CircleShape, TextShape};
use egui::text::LayoutJob;
use egui::{Align2, Color32, Pos2, Rect, TextFormat};
use rand::{thread_rng, Rng};
use serde::{Deserialize, Serialize};

use super::gizmo::GizmoComponent;
use crate::math::constants::*;
use crate::math::transformations::grid_to_image;
use crate::render::gradient::Gradient;
use crate::simulation::plugin::ComponentIDs;
use crate::ui::state::ToolType;

/// A sound source on the grid
#[derive(Debug, Default, Component, Serialize, Deserialize, Clone, PartialEq, Copy)]
pub struct Source {
    pub x: u32,
    pub y: u32,
    /// type of the source
    pub source_type: SourceType,
    pub id: usize,
}

#[derive(Debug, PartialEq, Serialize, Deserialize, Clone, Copy)]
pub enum SourceType {
    Sin {
        /// phase shift of the sin (in °)
        phase: f32,
        /// frequency of the sin (in Hz)
        frequency: f32,
        /// amplitude of the sin (currently unitless)
        amplitude: f32,
    },
    Gauss {
        /// phase shift of the bell (in °)
        phase: f32,
        /// frequency of the bell (in Hz)
        frequency: f32,
        /// amplitude of the bell (currently unitless)
        amplitude: f32,
        std_dev: f32,
    },
    WhiteNoise {
        /// amplitude of the noise (currently unitless)
        amplitude: f32,
    },
}

impl Default for SourceType {
    fn default() -> Self {
        SourceType::Sin {
            amplitude: 10.,
            phase: 0.0,
            frequency: 1000.0,
        }
    }
}

impl SourceType {
    pub fn default_sin() -> SourceType {
        SourceType::Sin {
            amplitude: 10.,
            phase: 0.0,
            frequency: 1000.0,
        }
    }
    pub fn default_gauss() -> SourceType {
        SourceType::Gauss {
            amplitude: 10.,
            phase: 0.0,
            frequency: 1000.0,
            std_dev: 0.45,
        }
    }
    pub fn default_noise() -> SourceType {
        SourceType::WhiteNoise { amplitude: 10. }
    }
}

impl fmt::Display for SourceType {
    fn fmt(&self, f: &mut fmt::Formatter<'_>) -> fmt::Result {
        match self {
            SourceType::Sin { .. } => write!(f, "Sinusoidal"),
            SourceType::Gauss { .. } => write!(f, "Gaussian"),
            SourceType::WhiteNoise { .. } => write!(f, "White Noise"),
        }
    }
}

impl Source {
    pub fn new(x: u32, y: u32, source_type: SourceType, id: usize) -> Self {
        Self {
            x,
            y,
            source_type,
            id,
        }
    }

    pub fn calc(&self, time: f32, rotator: usize) -> f32 {
        match self.source_type {
            SourceType::Sin {
                phase,
                frequency,
                amplitude,
            } => self.sin(time, phase, frequency, amplitude),
            SourceType::Gauss {
                phase,
                amplitude,
                frequency,
                std_dev,
            } => self.periodic_gaussian(time, frequency, amplitude, phase, 4., 0., std_dev),
            SourceType::WhiteNoise { amplitude } => WN_VALUES[rotator] * amplitude,
        }
    }

    fn sin(&self, time: f32, phase: f32, frequency: f32, amplitude: f32) -> f32 {
        amplitude * (2. * PI * frequency * time - phase.to_radians()).sin()
    }

    fn periodic_gaussian(
        &self,
        time: f32,
        frequency: f32,
        amplitude: f32,
        phase: f32,
        period: f32,
        mean: f32,
        standard_deviation: f32,
    ) -> f32 {
        // Ensure x is within the periodic domain (-period/2 ; period/2)
        let x = ((2. * PI * frequency * time - phase.to_radians()) % period) - (period / 2.);

        // Calculate the Gaussian function value
        let exp_term = (-0.5 * ((x - mean) / standard_deviation).powi(2)).exp();
        let scaling_factor = 1.0 / (standard_deviation * (2.0 * PI).sqrt());

        amplitude * scaling_factor * exp_term
    }

    pub fn spawn_initial_sources(mut commands: Commands, mut component_ids: ResMut<ComponentIDs>) {
        commands.spawn(Source::new(
            (SIMULATION_WIDTH + 2 * INIT_BOUNDARY_WIDTH) / 2,
            (SIMULATION_HEIGHT + 2 * INIT_BOUNDARY_WIDTH) / 2,
            SourceType::default_sin(),
            component_ids.get_new_source_id(),
        ));
        commands.spawn(Source::new(
            (SIMULATION_WIDTH + 2 * INIT_BOUNDARY_WIDTH) / 3,
            (SIMULATION_HEIGHT + 2 * INIT_BOUNDARY_WIDTH) / 3,
            SourceType::default_sin(),
            component_ids.get_new_source_id(),
        ));
    }
}

impl GizmoComponent for Source {
    fn get_gizmo_positions(&self, tool_type: &ToolType) -> Vec<Pos2> {
        match tool_type {
            ToolType::Place(..) | ToolType::Move | ToolType::Select => {
                vec![Pos2 {
                    x: self.x as f32,
                    y: self.y as f32,
                }]
            }
            _ => {
                unreachable!()
            }
        }
    }

    fn draw_gizmo(
        &self,
        painter: &egui::Painter,
        tool_type: &ToolType,
        highlight: bool,
        image_rect: &Rect,
        text: Option<&str>,
        _delta_l: f32,
        current_gradient: Gradient,
    ) {
        let (gizmo_color, text_color) = match current_gradient {
            Gradient::Turbo => (Color32::from_rgb(1, 89, 88), Color32::WHITE),
            _ => (Color32::from_rgb(15, 194, 192), Color32::BLACK),
        };

        match tool_type {
            ToolType::Place(..) | ToolType::Move | ToolType::Select => {
                for pos in self.get_gizmo_positions(tool_type) {
                    painter.add(egui::Shape::Circle(CircleShape::filled(
                        grid_to_image(pos, image_rect),
                        if highlight { 15. } else { 10. },
                        gizmo_color,
                    )));
                    if let Some(text) = text {
                        let galley = {
                            let layout_job = LayoutJob::single_section(
                                text.to_owned(),
                                TextFormat {
                                    color: text_color,
                                    background: Color32::TRANSPARENT,
                                    ..Default::default()
                                },
                            );
                            painter.layout_job(layout_job)
                        };
                        let rect = Align2::CENTER_CENTER.anchor_size(
                            grid_to_image(
                                Pos2 {
                                    x: self.x as f32,
                                    y: self.y as f32,
                                },
                                image_rect,
                            ),
                            galley.size(),
                        );
                        painter.add(TextShape::new(rect.min, galley, Color32::BLACK));
                    }
                }
            }
            _ => {}
        }
    }
}

const WN_VALUES: [f32; 1000] = [
    0.7767981198828222,
    0.7645333548193994,
    0.7403223612403431,
    0.9331430334803352,
    0.480896445057696,
    -0.7324551711089303,
    -0.7440177890216985,
    0.5289352489832574,
    0.5071418490687146,
    -0.9515409505171019,
    -1.2138437406948022,
    0.2782183977176517,
    1.357496911603405,
    0.5867177286307274,
    -0.9351820528439141,
    -1.1617532814312714,
    -0.14451821475569046,
    0.2029117196688933,
    -0.38695214296303043,
    -0.47509635425439645,
    0.13545212180916938,
    0.5605549246933104,
    0.48664642996941776,
    0.2696167213159792,
    0.5994306112143732,
    1.2129363076122806,
    0.8189130370669192,
    -0.05080105104098463,
    0.045892153650738995,
    0.023407138271395407,
    -0.7239275277428693,
    -0.3034171039535872,
    0.6470906276213398,
    0.1164915525068678,
    0.030822077795788008,
    1.4116167484903261,
    1.2629276962808396,
    -0.11132596546653474,
    0.2096760806666293,
    0.6432749963878693,
    -0.4304642638045615,
    -0.40271507233858955,
    0.7551134331999376,
    0.11568789703411507,
    -1.166085525753327,
    -0.46708327537028416,
    0.6795384669888713,
    0.24758801498328506,
    -0.5338747825515786,
    -0.29061843069065235,
    0.07528452796506287,
    -0.4178402088041423,
    -0.9078908928428486,
    -0.5533992617406801,
    -0.13824254562658073,
    0.04451854121480221,
    0.5633040215573174,
    0.3577032057120768,
    -1.1581613968410502,
    -1.50924843688681,
    0.09307475482224134,
    0.6829205669825706,
    -0.35910314739851407,
    -0.419170875046273,
    0.6520123424712427,
    0.7923222785789006,
    -0.1875862123048257,
    -0.9578913782002029,
    -0.6877147766303826,
    0.2757742053854483,
    0.6657376818775346,
    0.20344328793057567,
    0.06466410063409869,
    0.3852858156079076,
    0.18133443709289163,
    -0.3397951144615815,
    -0.4146526404210334,
    -0.3294266449710765,
    -0.5055631539127516,
    -0.6858903923331208,
    -0.5847794794015072,
    -0.32953156308897236,
    -0.2899530696462919,
    -0.4068495194031906,
    0.00998110625091552,
    1.0422716694614316,
    1.6005010876060772,
    0.9134250538442905,
    -0.253665575494632,
    -0.451264370872468,
    0.3323756784848933,
    0.367743083764855,
    -0.6776016921695655,
    -0.7497520801037904,
    0.36760594567239,
    0.42603888684921687,
    -0.3289465912938012,
    -0.0031117613316154306,
    0.19583679567521034,
    -0.9052458030389038,
    -0.9489149599460809,
    0.56690897060077,
    0.7270271490738623,
    -0.4402497231586325,
    -0.5456962000890264,
    -0.07720641398092302,
    0.01322582482669134,
    0.516800675546102,
    0.7001306644290012,
    -0.09801181069927906,
    0.09609283989678832,
    1.1390641676069264,
    0.39766738281423775,
    -1.0859757878430438,
    -0.9196464843848572,
    -0.657822348752683,
    -1.2698397058747684,
    -0.38827813196865735,
    1.8105328083990313,
    2.1208123869071653,
    0.3715123707180213,
    -0.5431270082939188,
    0.3050314532150994,
    0.8605808129153902,
    -0.10373982111555918,
    -0.7568093270893456,
    0.24662368826370387,
    0.9548028094165711,
    0.19786458150079253,
    -0.16881914379245602,
    0.29321038949208816,
    0.03441355491979346,
    -0.5956766302241983,
    -0.6718482259281924,
    -0.858526386899747,
    -0.9696227073840242,
    -0.25065434520330154,
    0.21782743329417778,
    -0.2132003096300417,
    -0.4634373696295708,
    -0.44114672776247504,
    -0.5548191441771415,
    -0.1731713740359792,
    0.1799813478963321,
    -0.6071483283952875,
    -1.128911733627157,
    -0.1574428081147903,
    0.3000178872167959,
    -0.844174635123032,
    -1.2549808767947397,
    0.28316096252545914,
    1.824579992977997,
    1.8602449728777513,
    1.0004466736079225,
    0.3422068015330789,
    0.31071389540428096,
    0.3041116749029228,
    -0.44182169839424645,
    -1.0828024356772739,
    -0.3737002210312039,
    0.6763249415771122,
    0.4652240361580145,
    -0.3597765195024267,
    -0.38965865432115476,
    0.31947243276563736,
    0.6570732362591679,
    -0.27050014151406937,
    -1.6522641257757502,
    -1.4335933431411485,
    0.10058368517759585,
    0.3987590123948537,
    -0.38052417065589067,
    0.2311086256190127,
    1.5277366623250501,
    0.9091295236609156,
    -0.6355499146046016,
    -0.5510318484086854,
    0.29951164717916634,
    -0.017387162829244573,
    -0.627687906141507,
    -0.35105020817898774,
    -0.24116853667803329,
    -1.0010414232742795,
    -1.2835628057450126,
    -0.07855678016377557,
    1.2653968038138401,
    0.6407799537043946,
    -1.2852875362494172,
    -1.3769118770285076,
    0.5089575879308883,
    0.7631512858314892,
    -1.091177522928074,
    -1.520286849698661,
    -0.17923596965554164,
    0.10410011660280921,
    -0.3770863472754718,
    0.3748293952103662,
    1.2730276290200575,
    0.5462033936937587,
    -0.7111792985142157,
    -0.7537203750777466,
    -0.07447242067867549,
    -0.17884790357199384,
    -0.7730455243681872,
    -0.21092360721430906,
    1.2417788939294563,
    1.6005096069267726,
    0.7184547575528991,
    0.1313739221222135,
    0.32310201106416836,
    0.8245961763091377,
    1.032476593568222,
    0.4932182466939975,
    0.10216220717288821,
    0.6476322969145533,
    0.3939196696478375,
    -1.3461462916703473,
    -1.4485254798839626,
    0.9299270889393811,
    1.6226238062948388,
    -0.5686277489618455,
    -1.3708879041314133,
    0.41020517674442514,
    1.1126904555828945,
    0.1418294717874365,
    0.35175768105593364,
    1.4802922832133403,
    1.3793918449432487,
    0.7022990752780911,
    0.6191123774290317,
    0.43628127368510106,
    -0.028787838748299516,
    -0.15127015363836352,
    0.014801605261132573,
    0.3825217790119106,
    0.7288529904179718,
    0.39386742852320394,
    -0.2167403904947258,
    -0.3139910000187582,
    -0.3049708735747437,
    -0.20714785432088226,
    0.3525672204279399,
    0.19416140294359907,
    -0.9681561308647724,
    -0.923092385001021,
    0.6293695873959095,
    1.324695914517472,
    0.7685453710656857,
    0.15219038529841636,
    -0.5632394094925174,
    -1.014096367651364,
    -0.4086926808595946,
    0.10011309428051157,
    -0.3933377920776914,
    -0.695693545085598,
    -0.3992700005692594,
    0.04938331128990676,
    1.133412635975862,
    1.9534741649251723,
    0.729086747411759,
    -0.9723361889978223,
    -0.8435797274200303,
    -0.1550904163804052,
    -0.08462840280630843,
    0.32758848358237724,
    0.4149266991284869,
    -0.6629748780883283,
    -0.8544848228857276,
    0.3894935001849604,
    0.48803348932379237,
    -0.6197227489055072,
    -0.6888583840899614,
    -0.1411738158359691,
    -0.18020121403498834,
    -0.010879443286782508,
    0.30117369927457693,
    -0.07812017894190156,
    -0.015081819774147472,
    0.7658915302879591,
    0.27155442970634525,
    -0.8724754542781274,
    -0.09592185881888539,
    1.221131861977522,
    0.45242938216341794,
    -0.6862360663818502,
    -0.08958432478041345,
    0.6051895087991526,
    -9.83327967558345e-5,
    -0.8809951300098467,
    -1.199596214232811,
    -0.6711821444582136,
    0.6170346267068045,
    1.142870875111872,
    0.16781188477939105,
    -0.4391869499123026,
    0.2407028718268918,
    0.5288287847186516,
    -0.22373622994516212,
    -0.7907504835167187,
    -0.7414079589327227,
    -0.48290109959593924,
    -0.19341407636872293,
    -0.21200147822900028,
    -0.5454639292279545,
    -0.5882553687464557,
    -0.37017038880899034,
    -0.19103193174850364,
    0.13968539705456254,
    0.08004018266830816,
    -0.6730894752774809,
    -0.3694333691662522,
    1.3158951949714526,
    1.444803076667348,
    -0.4216958912952844,
    -1.081636337916831,
    -0.3480371701797265,
    -0.5487671756822523,
    -0.7527521578417858,
    0.308472358017786,
    0.5863727126271152,
    -0.1723445538673784,
    0.3955717501007438,
    1.2465244485838427,
    0.31086745375182784,
    -0.2505237077997135,
    0.6499331702990303,
    0.23956995265898762,
    -0.8473823195267696,
    0.4809733414175589,
    1.932565423451097,
    0.5819877603995144,
    -0.5423089978712315,
    0.2729509475263295,
    0.14704356621866888,
    -0.4946487745400668,
    0.7412172929974656,
    1.433506753214966,
    -0.059683573571649044,
    -0.31141877892461656,
    1.1298419720532336,
    0.7312144452191996,
    -0.7359334463584155,
    -0.38494701583763763,
    0.051643090928029156,
    -1.0501715270666967,
    -0.9159360019023632,
    1.0257952133642618,
    1.0600524292994489,
    -1.0103112196587776,
    -1.2283649548621625,
    0.3923641809290582,
    0.3457335108200808,
    -0.9227662945921579,
    -0.8797147752283749,
    -0.5901747497788826,
    -1.1030854404443438,
    -0.6048777580056481,
    0.4156609216236215,
    -0.11882572524328537,
    -0.3448874256661145,
    1.2386810573531357,
    1.5761380466371286,
    -0.05652306081284391,
    -0.4045009511652185,
    0.5053198720027574,
    0.5333539054471271,
    0.4568978466163476,
    0.6863106040219628,
    0.029518607349247782,
    -0.4893929758722768,
    0.10578092940498186,
    0.40589435998144574,
    0.5068910091591492,
    1.2287776370618586,
    0.8883664199451804,
    -0.5526724475466874,
    -0.5292374380063513,
    0.2250974587389921,
    -0.3659556803813782,
    -0.5618970447738763,
    0.6428969880318262,
    0.8066194640114926,
    -0.24143818153285695,
    -0.3933707424761881,
    -0.07725169274751528,
    -0.22293227108409208,
    0.13789202940974993,
    0.7202573592189369,
    0.10600557267983271,
    -0.8778190148693692,
    -0.7347760421919,
    -0.10744548804673898,
    0.025326398023058663,
    -0.0007945416095719252,
    -0.007498706427139351,
    -0.29410564416353174,
    -0.3860136452757831,
    0.17301267224435432,
    0.4721738059881249,
    -0.29329338424061074,
    -1.1389589670233868,
    -0.7405819337797865,
    0.593724532075236,
    1.3725597103472804,
    0.6327697662328879,
    -0.8929503755462888,
    -1.4822020330875998,
    -0.7698980084433729,
    -0.12560063052497805,
    -0.24942064911058756,
    -0.5388911651583153,
    -0.7626430516278283,
    -0.9733084415652979,
    -0.5150807288957687,
    0.8101228164229164,
    1.72861374757995,
    1.1984623366664096,
    -0.069458313776071,
    -0.9688575268113991,
    -1.4444655179194428,
    -1.492986591502866,
    -0.8697852967291242,
    -0.5620401935103103,
    -1.358364427229153,
    -1.6036244969709716,
    -0.5117366835277664,
    -0.40185466525826763,
    -1.4654629754332864,
    -0.6979274725767081,
    1.3787497607548185,
    1.542203633443272,
    0.6912068064912595,
    0.9277008739176293,
    0.693040862426418,
    -0.2717141013959332,
    0.45219076270155883,
    1.5080895918880268,
    0.1537127919570873,
    -1.0677790605181563,
    0.3141001845575513,
    1.3436281441628424,
    0.44000255517055825,
    0.24245287706915195,
    1.067033538213307,
    0.8888770802983862,
    0.2781777919045561,
    0.34724605351153465,
    0.20283921344079914,
    -0.24094751596554279,
    -0.04354852071950694,
    0.3929729435997256,
    0.4004542326336368,
    0.14391469760245518,
    -0.25040013974014197,
    -0.26542211983692915,
    0.42213766662436686,
    0.39271843293022185,
    -0.8619035386516889,
    -1.0432783084217967,
    0.4657085733447049,
    1.1032976579120972,
    0.3571462660209628,
    0.19552034559222958,
    0.40480063459205345,
    -0.3413229587492067,
    -1.0102796450830291,
    -0.42384463847731374,
    0.3494375753759932,
    0.23254201538465,
    -0.2240116879645613,
    -0.15319709869099732,
    0.43286980036214606,
    0.9784690572542529,
    1.3078609882036996,
    1.2743068029240388,
    0.14128961828876432,
    -1.5433894659528868,
    -1.567892696731653,
    -0.10436223581343701,
    0.17025707746447233,
    -0.6979114076299853,
    -0.6302938218509971,
    -0.14640884044387104,
    -0.28793658068357864,
    -0.020083068272933397,
    0.4840529029693986,
    -0.12322673255877184,
    -0.7780622126191511,
    -0.2566085317516819,
    0.12768230048157023,
    -0.11550203148499058,
    0.2717107456049981,
    0.8759870464056508,
    0.3612824151185345,
    -0.6250171529011036,
    -0.7381888014323953,
    -0.1885438086462251,
    -0.23889509579400312,
    -1.2957650509746652,
    -1.9217172957339035,
    -1.0338477990592136,
    -0.2890698775272462,
    -1.1320160835119988,
    -1.7131559456718926,
    -0.45126750601461574,
    1.1406488449449685,
    1.7190494064313457,
    1.5231817830622385,
    0.39878609035319695,
    -1.1108689702420271,
    -1.0381823543218356,
    0.49298570863549834,
    0.9525429837481268,
    -0.1697336246625299,
    -0.7880564165272281,
    0.15487131471353843,
    1.419295163772513,
    1.3394435253774855,
    0.11254865005222567,
    -0.2551391127384038,
    0.7892384360398462,
    1.2344653887566799,
    0.20302044776672354,
    -0.6424626921723346,
    -0.325024658417079,
    0.37041976227644813,
    0.7437331258529409,
    0.6438707431439663,
    0.27526645638797437,
    0.15024261063373384,
    0.0788539988448202,
    -0.6084369083311328,
    -1.360729845759407,
    -1.0316476104548615,
    0.02422232864678837,
    0.3562085128100478,
    -0.42158255321474947,
    -0.919478063536674,
    0.07745491079015758,
    1.3704582886889956,
    1.135440755068161,
    0.2273113483717737,
    0.06967849460634856,
    -0.44774891043207854,
    -1.6538216446770793,
    -1.4276608592948343,
    -0.1807169733992032,
    -0.4985608767479468,
    -1.3292497090731867,
    -0.4525220405579786,
    0.5559480774463207,
    0.21323778852050707,
    -0.3166228593733756,
    -0.7477729293477158,
    -0.9037143803501321,
    0.3576521873353834,
    1.3258433952174162,
    -0.040873322872329775,
    -0.9877094501712227,
    0.25600869084636846,
    0.4981661716794727,
    -0.8951004904825137,
    -0.7786325586651566,
    0.6262707112633845,
    0.992826933990454,
    0.5881836209927104,
    0.14512453149313959,
    -0.3880541788388012,
    -0.508196338335079,
    -0.4682100438915234,
    -0.8242489447613908,
    -0.7047395311168159,
    -0.10013307245731348,
    -0.17149517044144838,
    -0.2291958235074424,
    0.46797097080868,
    0.6655301656612533,
    0.5053039873113407,
    1.219734928897054,
    1.3924740462435095,
    0.02507700312040742,
    -0.6362741019778115,
    -0.021284561673857186,
    -0.022218007542183584,
    0.10180650568131329,
    1.4819012877185505,
    1.6093690809170624,
    -0.27569217979843247,
    -0.7069554370252369,
    0.6769100244304931,
    0.4896182195059845,
    -0.9209781921817503,
    -0.8023036767949424,
    -0.1623612469254758,
    -0.8574626723687174,
    -1.4688223609490199,
    -0.6840445190213215,
    0.597465776058205,
    1.4123999563390892,
    1.1116984445896843,
    -0.1801774710672408,
    -0.6127928597443979,
    0.2276587693491896,
    -0.03706376987545099,
    -1.494675791490132,
    -1.1938745123121426,
    0.8379626843569352,
    1.6059802221071078,
    0.8610470953472487,
    0.6685675152716334,
    0.9077445400073082,
    -0.04113481705098593,
    -1.5578893665729543,
    -1.2615977232197564,
    0.8256144111986476,
    1.7008688558596612,
    0.3636044666233424,
    -0.46392607108779005,
    0.3805487074227414,
    0.7836751535618992,
    0.3515511165616678,
    0.7096340140474806,
    1.153942392252404,
    0.33579449522879473,
    -0.3563696635842031,
    0.14076376507142072,
    0.5025607780732365,
    0.19829082044314505,
    0.18491463600511127,
    0.6017954153643457,
    0.6926352269401331,
    -0.06188732794195312,
    -1.1438840706924738,
    -1.211904942422813,
    -0.3604064706178501,
    -0.06858831792991593,
    -0.09231007043917241,
    0.5263916118793762,
    0.806426672075602,
    0.37257631073381414,
    0.587476980216685,
    1.0809507047808924,
    0.4107284223619289,
    -0.8062580378315952,
    -1.3091746384592833,
    -0.7153915298744599,
    0.6884818137238294,
    1.085271882111379,
    -0.3977549120114824,
    -0.9532479199178145,
    0.45920000745618295,
    0.2738126342443583,
    -1.8240213222458959,
    -1.6366008781654788,
    0.4022262330088018,
    0.013726046718696872,
    -1.9110406255871772,
    -1.452563983908851,
    0.5428529156671181,
    0.7179757203650954,
    -0.6851781667533972,
    -1.2051735127942442,
    -0.5543379698334722,
    -0.17244212970231768,
    -0.2753499748886465,
    -0.11193469284066798,
    -0.02314485979383718,
    -0.6568577220920447,
    -1.2046894281190836,
    -0.7571901346884052,
    -0.0319821930455118,
    0.06570896003665833,
    -0.1540475093020361,
    -0.3678856236307357,
    -0.674835359111303,
    -0.4228334600537257,
    0.6331588667890441,
    0.7693144430902925,
    -0.5643961405801049,
    -0.7298543050117758,
    0.9526646454111397,
    1.2868689834498908,
    -0.18280548979385053,
    -0.39114846507679446,
    0.24850038101373007,
    -0.6727581231202592,
    -1.4043844312895273,
    -0.2582487455002623,
    0.1704159135953351,
    -0.6184161561824173,
    0.27446240034567343,
    1.7218774329907998,
    0.5741957616720601,
    -1.051626029354025,
    -0.3003606015712383,
    0.7090245985667659,
    0.38469687949289233,
    0.34735076358406747,
    0.4497201866442052,
    -0.24867611438340187,
    -0.10213146092251899,
    1.0049509180030336,
    0.3103601529662533,
    -1.8689518346713645,
    -2.2130731828979373,
    -0.442052753099218,
    0.8498872062506249,
    0.5611024604015827,
    -0.22420088658702908,
    -0.23462375929670845,
    0.2555603178920918,
    -0.07393723598846233,
    -0.8883469928948989,
    -0.668477983967597,
    -0.10176917092802984,
    -0.505919450658073,
    -0.42539519649388047,
    0.996956313288166,
    1.3198930676768572,
    0.08184866179437145,
    0.2621168204556122,
    1.6781239995793484,
    1.2928235024847512,
    0.1666052926191632,
    0.9138722468837092,
    1.456480804451663,
    -0.028968441529207335,
    -0.41964987741314325,
    1.4262977031079505,
    1.9228699589239349,
    0.41781633218505265,
    -0.00037909419537085834,
    0.7573379154471094,
    0.6017796715425066,
    -0.05503100358999734,
    -0.008446005261129085,
    0.20952736885812984,
    0.01202877835006293,
    0.03428381742258131,
    0.8610715485905914,
    1.4647123761691034,
    0.47730668155718614,
    -0.6203271621233589,
    0.37966573101360795,
    1.4486985193748245,
    0.07763794731757544,
    -1.217709156145829,
    -0.39248893616709934,
    0.04250218013472585,
    -0.5811658804370718,
    -0.0305234980639116,
    0.8649713910359911,
    0.2858738962477434,
    -0.2794860453024992,
    0.34965852990010476,
    0.9986758202521198,
    1.004534135131765,
    0.440982528630669,
    -0.34972355596571447,
    -0.2997369649104423,
    0.4933388764649201,
    0.8897919908066789,
    1.3031862892860355,
    2.0077466209391517,
    1.492361412256804,
    -0.23092032551591918,
    -1.1363818972616129,
    -0.6960508844684451,
    0.01370590273855711,
    0.19404561448000288,
    -0.4015874915373331,
    -1.2062862396258809,
    -1.2326848799130161,
    -0.3476209557817167,
    0.7091710750914489,
    0.9283956492610461,
    0.05857911638564396,
    -0.5618276848424295,
    -0.24380493504804243,
    -0.23453601298114166,
    -0.3924950733948815,
    0.6675772968985515,
    1.498558573312063,
    0.42255355380978615,
    -0.46963057358323235,
    0.18653134767964646,
    0.3303862391337115,
    -0.5151699266399639,
    -0.4858892001096822,
    0.33858426929997715,
    0.4225414445594276,
    -0.3889249772941855,
    -1.1047608858501166,
    -0.8980663356461537,
    -0.1544855199979508,
    0.038752220202829854,
    0.1424442447889147,
    1.1040080469291833,
    1.500116496218177,
    0.06846491967788741,
    -1.2230045579065434,
    -0.6821236189612011,
    0.11437362108601794,
    -0.5318910704968949,
    -1.5983604417338537,
    -1.153166414618515,
    0.4374130236543026,
    0.6996157943266977,
    -0.7097994468737214,
    -0.9266432952639382,
    0.7682851200345289,
    1.452154556462068,
    0.39420485858338633,
    0.09249110686835234,
    0.9687486245225538,
    1.2405297610502939,
    0.7809178315468092,
    0.4550302744363776,
    0.1621127484012547,
    -0.22825467310904587,
    -0.6497880426799559,
    -1.2396323315552622,
    -1.348278958671305,
    -0.4965145706003459,
    -0.07957948949965321,
    -0.7745379882117865,
    -0.8323392238586294,
    -0.05585377663830509,
    -0.5764614448407783,
    -1.8795423556214514,
    -1.4427206675155022,
    -0.03569319012460001,
    0.10669943145926367,
    -0.15886652666042822,
    0.5396346050624187,
    1.0746804526071974,
    0.6985157482397351,
    0.5437354126664128,
    1.0733656456918683,
    1.5302944799144085,
    1.4586874253901523,
    0.8397846124935094,
    -0.0010638794827000503,
    -0.2914881354808913,
    0.11657802700595339,
    0.41360926388969044,
    0.22333845801887556,
    -0.027773458844753383,
    -0.03642422399648612,
    0.18213717924968548,
    0.4872660243311101,
    0.7557430774908984,
    1.1039995973710066,
    1.2884852628835535,
    0.7679185583818172,
    0.24306343936569927,
    0.5384267149848598,
    0.32844657298988533,
    -0.9631839632634377,
    -0.9918559574443684,
    0.5967987410617956,
    0.9390595411154907,
    -0.028898397244797397,
    0.12269667981257976,
    0.7847326272933697,
    0.25968135259274644,
    -0.26450587444820006,
    0.3944757457295671,
    1.0520849622209498,
    0.7797362364135824,
    0.1519989826304012,
    -0.2508668690703132,
    -0.273087973977119,
    0.2277532605672164,
    0.8061780864008665,
    0.5672876644949822,
    0.09562896816408784,
    0.824922172618853,
    1.6372811733596204,
    0.668427333580469,
    -0.3658430684492506,
    0.08824467469817811,
    -0.2777357428806327,
    -1.6911734543804708,
    -1.1478280167997812,
    0.1559588543201234,
    -0.5678712114927328,
    -0.7038527347839549,
    1.2354053974466812,
    1.2078488499586175,
    -1.0078814672455239,
    -1.1653681922786787,
    -0.1876618685761858,
    -0.9617508193383248,
    -1.2466630931486795,
    0.09481118078790408,
    0.17430494957217496,
    -0.5436328405389599,
    0.32388054678776895,
    0.7451517783680682,
    -0.8403863075831501,
    -1.6000900874828679,
    -0.7060829151203462,
    -0.2925845414759988,
    0.1917127906399475,
    1.741551426105101,
    2.1172444440137617,
    0.6558674609481375,
    -0.11180015147261352,
    0.0017079658601152209,
    -0.6612735482195216,
    -1.074728478784177,
    -0.04311141691598719,
    0.8290020121665919,
    0.5167245747469189,
    -0.003753118765374707,
    -0.37094627985166195,
    -0.6986853499723283,
    -0.47662633255183323,
    0.08498950687271035,
    0.15114822313319048,
    -0.07468002331570994,
    -0.061116994103254385,
    -0.22083497688073622,
    -0.9628622365982735,
    -1.6227384486723355,
    -1.167564495959283,
    0.11967107774726708,
    0.4154126894727317,
    -0.7721303864000438,
    -1.217132889943361,
    -0.06732125310212339,
    0.26798823715081305,
    -0.8892776898453398,
    -1.1639984022793273,
    -0.3146695921397308,
    -0.16793220342487464,
    -0.28694826414532426,
    0.2843061477252322,
    0.34134618507250286,
    -0.4163196683495175,
    -0.35414194855159503,
    0.6612244357589749,
    1.1915607033951852,
    0.8456352700533599,
    0.07416521763551542,
    -0.7426824181921042,
    -0.8696743513430488,
    -0.03572719815462986,
    0.5671442934542679,
    0.0034736895341514855,
    -0.8733738915510868,
    -1.166306019914305,
    -1.3707327361581665,
    -1.7752959020976626,
    -1.6264904419225712,
    -0.8161563561827426,
    -0.1752570235780627,
    0.13186190433918,
    0.39315918098428226,
    0.2591494212116784,
    -0.27260166901376814,
    -0.41211517552172705,
    -0.23796517796643604,
    -0.42190912878890635,
    -0.4624270481515704,
    0.13407567445139976,
    0.4657671463724377,
    0.0002554225607918955,
    -0.600447226734488,
    -0.7124248178380583,
    -0.046175137246105155,
    0.7899184225847554,
    0.3368558655206679,
    -0.9109774320758546,
    -0.8764600835286375,
    -0.11790243926642824,
    -0.364840094670421,
    -0.42688633699480516,
    0.6733322708402419,
    0.8138074713522093,
    -0.6728468414875328,
    -1.2670112293524396,
    -0.0288561860597875,
    0.9215433570342694,
    -0.016505824124344686,
    -1.6025914677907498,
    -1.4819878730442924,
    0.1122665933527172,
    0.7467051418034623,
    0.33798242812822243,
    0.5888311831790665,
    0.8510151457581648,
    0.3395845859878688,
    0.6425700135731601,
    1.5252327563192347,
    0.5269985146531457,
    -1.6803909122425962,
    -2.0103258805760875,
    0.03834592970585832,
];
